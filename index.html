<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FV V√Ωroba a Spotreba Widget</title>
  <style>
    body {
      background: #141a1f;
      color: #e6efe6;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    .dashboard {
      width: 99vw;
      min-height: 98vh;
      display: flex;
      flex-direction: column;
      gap: 2vh;
      padding: 2vh 2vw;
    }
    .upper-section, .lower-section {
      display: flex;
      gap: 2vw;
      justify-content: space-between;
      align-items: flex-start;
    }
    .card {
      background: rgba(30, 50, 60, 0.91);
      border-radius: 12px;
      padding: 1.5vh 2vw;
      min-width: 220px;
      box-shadow: 0 0 10px #1a2a32c7;
    }
    /* Tok energie */
    .energy-flow {
      flex: 2;
      position: relative;
      background: #232e2e99;
      border-radius: 14px;
      padding: 2vw;
      min-height: 260px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    .flow-items {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }
    .flow-icon {
      font-size: 2em;
      margin: 0 1vw;
      text-align: center;
    }
    /* Kruhov√© grafy */
    .pie-charts {
      display: flex;
      gap: 3vw;
      align-items: center;
      justify-content: center;
    }
    .pie {
      width: 110px;
      height: 110px;
      position: relative;
    }
    .pie-title {
      text-align: center;
      font-weight: bold;
      margin-top: 0.5em;
    }
    /* Ostatn√© */
    .stat-bar {
      height: 60px;
      background: #214452;
      border-radius: 7px;
      margin-bottom: 6px;
      padding: 6px;
    }
    .weather, .ecology, .inverter {
      min-width: 160px;
    }
    .value-big {
      font-size: 2em;
      font-weight: bold;
      color: #4aff69;
    }
    .label {
      font-size: 0.95em;
      color: #b9ebd9;
      margin-bottom: 2px;
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <!-- Horn√° sekcia -->
    <div class="upper-section">
      <!-- ≈†tatistiky v√Ωroby -->
      <div class="card stat-bar">
        <div class="label">V√Ωroba spolu</div>
        <div class="value-big" id="totalGen">27,469.6 MWh</div>
        <div class="label">Pr√≠jem spolu</div>
        <div class="value-big" id="totalInc">0 EUR</div>
      </div>
      <!-- ≈†t√≠tok elektr√°rne -->
      <div class="card">
        <div class="label">Stanica: RoK1a</div>
        <div>Kapacita: <span id="capacity">10 kW</span></div>
        <div>Adresa: Pila, Slovensko</div>
        <div>Spustenie: 09.09.2022</div>
      </div>
      <!-- Poƒçasie -->
      <div class="card weather">
        <div class="label">Poƒçasie teraz</div>
        <div id="weather">19¬∞C, premenliv√©</div>
        <div>
          <span>15-21¬∞C</span><br>
          <span>14-24¬∞C zajtra</span>
        </div>
      </div>
      <!-- Ekologick√Ω pr√≠nos -->
      <div class="card ecology">
        <div class="label">CO‚ÇÇ u≈°etren√©</div>
        <div id="co2">0 kg</div>
        <div class="label">Stromy</div>
        <div id="trees">0</div>
      </div>
    </div>

    <!-- Sch√©ma toku energie -->
    <div class="energy-flow card">
      <div class="flow-items">
        <span class="flow-icon">üîÜ<br><span id="pvValue">4893.11 W</span></span>
        <span style="flex:1; text-align:center;">
          <span class="flow-icon">üîã<br><span id="batValue">0%</span></span>
        </span>
        <span class="flow-icon">üè†<br><span id="homeValue">3546.11 W</span></span>
        <span class="flow-icon">‚ö°<br><span id="gridValue">1347 W</span></span>
      </div>
    </div>

    <!-- Doln√° sekcia: Grafy a v√Ωkon -->
    <div class="lower-section">
      <!-- ≈†tatistika graf -->
      <div class="card" style="min-width:200px;">
        <div class="label">V√Ωroba - 12 mesiacov</div>
        <canvas id="barChart" width="210" height="110"></canvas>
      </div>
      <!-- Kruhov√© grafy -->
      <div class="card">
        <div class="pie-charts">
          <div>
            <canvas id="pieInHouse" class="pie"></canvas>
            <div class="pie-title">Vlastn√° spotreba</div>
          </div>
          <div>
            <canvas id="pieGrid" class="pie"></canvas>
            <div class="pie-title">Podiel do siete</div>
          </div>
        </div>
      </div>
      <!-- Menic/bat√©ria -->
      <div class="card inverter">
        <div class="label">Meniƒç:</div>
        <div id="inverterStatus">Pracuje</div>
      </div>
    </div>
  </div>
  <!-- JS pre dynamick√© d√°ta a grafy -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Naƒç√≠tanie d√°t z JSONu
    // let data = ... // naƒç√≠taj vlastn√Ω JSON tu

    // Pr√≠klad demo d√°t:
    let barData = [520, 610, 410, 700, 770, 670, 850, 800, 1030, 950, 1200, 1280];
    let barLabels = ['1','2','3','4','5','6','7','8','9','10','11','12'];
    let pie1 = [4.15, 10.25]; // in-house, feed-in
    let pie2 = [4.15, 1.78]; // PV+BAT, grid

    // Bar chart
    new Chart(document.getElementById('barChart'), {
      type: 'bar',
      data: {
        labels: barLabels,
        datasets: [{
          label: 'V√Ωroba (kWh)',
          data: barData,
          backgroundColor: '#4aff69bb'
        }]
      },
      options: { plugins:{legend:{display:false}}, scales: {y:{beginAtZero:true}} }
    });

    // Pie chart 1: vlastn√° spotreba vs feed-in
    new Chart(document.getElementById('pieInHouse'), {
      type: 'doughnut',
      data: {
        labels: ['Vlastn√°', 'Do siete'],
        datasets: [{
          data: pie1,
          backgroundColor: ['#39e09b','#274683']
        }]
      },
      options: { plugins:{legend:{display:false}}, cutout: '65%' }
    });

    // Pie chart 2: PV+BAT vs grid
    new Chart(document.getElementById('pieGrid'), {
      type: 'doughnut',
      data: {
        labels: ['PV+BAT', 'Zo siete'],
        datasets: [{
          data: pie2,
          backgroundColor: ['#19bfff','#e0e14a']
        }]
      },
      options: { plugins:{legend:{display:false}}, cutout: '65%' }
    });
  </script>
</body>
</html>
